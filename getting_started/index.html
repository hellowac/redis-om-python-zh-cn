
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="å¯¹è±¡æ˜ å°„, ä»¥åŠæ›´å¤š, åŸºäº Redis å’Œ Python">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../connections/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.4">
    
    
      
        <title>å…¥é—¨ Redis OM - redis-om-python-zh-cn</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bd3936ea.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="red">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#redis-om" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="redis-om-python-zh-cn" class="md-header__button md-logo" aria-label="redis-om-python-zh-cn" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            redis-om-python-zh-cn
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              å…¥é—¨ Redis OM
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="red"  aria-label="åˆ‡æ¢åˆ°å¤œé—´æ¨¡å¼"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="åˆ‡æ¢åˆ°å¤œé—´æ¨¡å¼" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="black"  aria-label="åˆ‡æ¢åˆ°ç™½å¤©æ¨¡å¼"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="åˆ‡æ¢åˆ°ç™½å¤©æ¨¡å¼" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/hellowac/redis-om-python-zh-cn" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="redis-om-python-zh-cn" class="md-nav__button md-logo" aria-label="redis-om-python-zh-cn" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    redis-om-python-zh-cn
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hellowac/redis-om-python-zh-cn" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¦‚è§ˆ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    å…¥é—¨ Redis OM
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    å…¥é—¨ Redis OM
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    ç®€ä»‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    å…ˆå†³æ¡ä»¶
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    Python
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis" class="md-nav__link">
    Redis
  </a>
  
    <nav class="md-nav" aria-label="Redis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redis_1" class="md-nav__link">
    ä¸‹è½½ Redis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-redis" class="md-nav__link">
    åœ¨ Windows ä¸Šå®‰è£… Redis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redisearch-redisjson" class="md-nav__link">
    æ¨èï¼šRediSearch å’Œ RedisJSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis_2" class="md-nav__link">
    å¯åŠ¨ Redis
  </a>
  
    <nav class="md-nav" aria-label="å¯åŠ¨ Redis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ubuntu-linux-wsl" class="md-nav__link">
    Ubuntu Linuxï¼ˆåŒ…æ‹¬ WSLï¼‰
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#homebrew-macos" class="md-nav__link">
    ä½¿ç”¨ Homebrew çš„ MacOS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    Docker
  </a>
  
    <nav class="md-nav" aria-label="Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redismod-docker" class="md-nav__link">
    ä½¿ç”¨ redismod é•œåƒçš„ Dockerï¼ˆæ¨èï¼‰
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redis-docker" class="md-nav__link">
    ä½¿ç”¨ redis é•œåƒçš„ Docker
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis-om_1" class="md-nav__link">
    å®‰è£… Redis OM
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis-url" class="md-nav__link">
    è®¾ç½® Redis URL ç¯å¢ƒå˜é‡
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    å®šä¹‰æ¨¡å‹
  </a>
  
    <nav class="md-nav" aria-label="å®šä¹‰æ¨¡å‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hashmodel" class="md-nav__link">
    HashModel ç±»
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ç±»å‹æ³¨è§£
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    åˆ›å»ºæ¨¡å‹
  </a>
  
    <nav class="md-nav" aria-label="åˆ›å»ºæ¨¡å‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    å¯é€‰å­—æ®µ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    é»˜è®¤å€¼
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    è‡ªåŠ¨ä¸»é”®
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    æ•°æ®éªŒè¯
  </a>
  
    <nav class="md-nav" aria-label="æ•°æ®éªŒè¯">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    æ¨¡å‹é»˜è®¤å¼ºåˆ¶è½¬æ¢å€¼
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    ä¸¥æ ¼éªŒè¯
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    ä¿å­˜æ¨¡å‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    è¿‡æœŸæ¨¡å‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis_3" class="md-nav__link">
    åœ¨ Redis ä¸­æ£€æŸ¥æ•°æ®
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    è·å–æ¨¡å‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    ä½¿ç”¨è¡¨è¾¾å¼æŸ¥è¯¢æ¨¡å‹
  </a>
  
    <nav class="md-nav" aria-label="ä½¿ç”¨è¡¨è¾¾å¼æŸ¥è¯¢æ¨¡å‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    ä¿å­˜å’ŒæŸ¥è¯¢å¸ƒå°”å€¼
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis_4" class="md-nav__link">
    è°ƒç”¨å…¶ä»– Redis å‘½ä»¤
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    ä¸‹ä¸€æ­¥
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../connections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è¿æ¥åˆ° Redis
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¨¡å‹å’Œå­—æ®µ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    éªŒè¯
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../redis_modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis æ¨¡å—
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../fastapi_integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FastAPI é›†æˆ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é”™è¯¯
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    ç®€ä»‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    å…ˆå†³æ¡ä»¶
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    Python
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis" class="md-nav__link">
    Redis
  </a>
  
    <nav class="md-nav" aria-label="Redis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redis_1" class="md-nav__link">
    ä¸‹è½½ Redis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-redis" class="md-nav__link">
    åœ¨ Windows ä¸Šå®‰è£… Redis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redisearch-redisjson" class="md-nav__link">
    æ¨èï¼šRediSearch å’Œ RedisJSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis_2" class="md-nav__link">
    å¯åŠ¨ Redis
  </a>
  
    <nav class="md-nav" aria-label="å¯åŠ¨ Redis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ubuntu-linux-wsl" class="md-nav__link">
    Ubuntu Linuxï¼ˆåŒ…æ‹¬ WSLï¼‰
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#homebrew-macos" class="md-nav__link">
    ä½¿ç”¨ Homebrew çš„ MacOS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    Docker
  </a>
  
    <nav class="md-nav" aria-label="Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redismod-docker" class="md-nav__link">
    ä½¿ç”¨ redismod é•œåƒçš„ Dockerï¼ˆæ¨èï¼‰
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redis-docker" class="md-nav__link">
    ä½¿ç”¨ redis é•œåƒçš„ Docker
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis-om_1" class="md-nav__link">
    å®‰è£… Redis OM
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis-url" class="md-nav__link">
    è®¾ç½® Redis URL ç¯å¢ƒå˜é‡
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    å®šä¹‰æ¨¡å‹
  </a>
  
    <nav class="md-nav" aria-label="å®šä¹‰æ¨¡å‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hashmodel" class="md-nav__link">
    HashModel ç±»
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ç±»å‹æ³¨è§£
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    åˆ›å»ºæ¨¡å‹
  </a>
  
    <nav class="md-nav" aria-label="åˆ›å»ºæ¨¡å‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    å¯é€‰å­—æ®µ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    é»˜è®¤å€¼
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    è‡ªåŠ¨ä¸»é”®
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    æ•°æ®éªŒè¯
  </a>
  
    <nav class="md-nav" aria-label="æ•°æ®éªŒè¯">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    æ¨¡å‹é»˜è®¤å¼ºåˆ¶è½¬æ¢å€¼
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    ä¸¥æ ¼éªŒè¯
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    ä¿å­˜æ¨¡å‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    è¿‡æœŸæ¨¡å‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis_3" class="md-nav__link">
    åœ¨ Redis ä¸­æ£€æŸ¥æ•°æ®
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    è·å–æ¨¡å‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    ä½¿ç”¨è¡¨è¾¾å¼æŸ¥è¯¢æ¨¡å‹
  </a>
  
    <nav class="md-nav" aria-label="ä½¿ç”¨è¡¨è¾¾å¼æŸ¥è¯¢æ¨¡å‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    ä¿å­˜å’ŒæŸ¥è¯¢å¸ƒå°”å€¼
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis_4" class="md-nav__link">
    è°ƒç”¨å…¶ä»– Redis å‘½ä»¤
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    ä¸‹ä¸€æ­¥
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="redis-om">å…¥é—¨ Redis OM</h1>
<h2 id="_1">ç®€ä»‹</h2>
<p>æœ¬æ•™ç¨‹å°†å¼•å¯¼æ‚¨å®‰è£… Redis OMï¼Œåˆ›å»ºç¬¬ä¸€ä¸ªæ¨¡å‹ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥ä¿å­˜å’ŒéªŒè¯æ•°æ®ã€‚</p>
<h2 id="_2">å…ˆå†³æ¡ä»¶</h2>
<p>Redis OM éœ€è¦ Python ç‰ˆæœ¬ 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬ä»¥åŠä¸€ä¸ª Redis å®ä¾‹è¿›è¡Œè¿æ¥ã€‚</p>
<h2 id="python">Python</h2>
<p>ç¡®ä¿æ‚¨æ­£åœ¨è¿è¡Œ <strong>Python ç‰ˆæœ¬ 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬</strong>ï¼š</p>
<div class="highlight"><pre><span></span><code>python --version
Python 3.8.0
</code></pre></div>
<p>å¦‚æœæ‚¨å°šæœªå®‰è£… Pythonï¼Œå¯ä»¥ä» <a href="https://www.python.org/downloads/">Python.org</a> ä¸‹è½½ï¼Œä½¿ç”¨ <a href="https://github.com/pyenv/pyenv">pyenv</a>ï¼Œæˆ–é€šè¿‡æ“ä½œç³»ç»Ÿçš„åŒ…ç®¡ç†å™¨å®‰è£… Pythonã€‚</p>
<p>æ­¤åº“éœ€è¦ <a href="https://pypi.org/project/redis">redis-py</a> ç‰ˆæœ¬ 4.2.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚</p>
<h2 id="redis">Redis</h2>
<p>Redis OM å°†æ•°æ®ä¿å­˜åœ¨ Redis ä¸­ï¼Œå› æ­¤æ‚¨éœ€è¦å®‰è£…å¹¶è¿è¡Œ Redis ä»¥å®Œæˆæœ¬æ•™ç¨‹ã€‚</p>
<p>æˆ‘ä»¬æ¨èä½¿ç”¨ <a href="https://hub.docker.com/r/redis/redis-stack">redis-stack</a> é•œåƒï¼Œå› ä¸ºå®ƒåŒ…å«æ­¤åº“ç”¨æ¥æä¾›é¢å¤–åŠŸèƒ½çš„ Redis åŠŸèƒ½ã€‚æŒ‡å—åé¢çš„éƒ¨åˆ†å°†æä¾›æœ‰å…³è¿™äº›åŠŸèƒ½çš„æ›´å¤šç»†èŠ‚ã€‚</p>
<p>æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å®˜æ–¹çš„ Redis Docker é•œåƒï¼Œè¯¥é•œåƒæ‰˜ç®¡åœ¨ <a href="https://hub.docker.com/_/redis">Docker Hub</a> ä¸Šã€‚ç„¶è€Œï¼Œè¿™ä¸ªé•œåƒä¸åŒ…æ‹¬å­˜å‚¨ JSON æ¨¡å‹å’Œä½¿ç”¨ <code>find</code> æŸ¥è¯¢æ¥å£æ‰€éœ€çš„æœç´¢å’Œ JSON æ¨¡å—ã€‚</p>
<p><strong>æ³¨æ„</strong>ï¼šå½“æˆ‘ä»¬åœ¨æœ¬æŒ‡å—çš„åé¢è®¨è®ºå¦‚ä½•å®é™…å¯åŠ¨ Redis æ—¶ï¼Œå°†è°ˆåˆ°ä½¿ç”¨ Docker å¯åŠ¨ Redisã€‚</p>
<h3 id="redis_1">ä¸‹è½½ Redis</h3>
<p>Redis çš„æœ€æ–°ç‰ˆæœ¬å¯ä» <a href="https://redis.io/">Redis.io</a> è·å–ã€‚æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡æ“ä½œç³»ç»Ÿçš„åŒ…ç®¡ç†å™¨å®‰è£… Redisã€‚</p>
<p><strong>æ³¨æ„</strong>ï¼šæœ¬æ•™ç¨‹å°†æŒ‡å¯¼æ‚¨å¦‚ä½•åœ¨æœ¬åœ°å¯åŠ¨ Redisï¼Œä½†å¦‚æœ Redis åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œè¿™äº›è¯´æ˜ä¹Ÿé€‚ç”¨ã€‚</p>
<h3 id="windows-redis">åœ¨ Windows ä¸Šå®‰è£… Redis</h3>
<p>Redis ä¸èƒ½ç›´æ¥åœ¨ Windows ä¸Šè¿è¡Œï¼Œä½†æ‚¨å¯ä»¥ä½¿ç”¨ Windows å­ç³»ç»Ÿ Linux (WSL) æ¥è¿è¡Œ Redisã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… <a href="https://youtu.be/_nFwPTHOMIY">æˆ‘ä»¬åœ¨ YouTube ä¸Šçš„è§†é¢‘</a>ã€‚</p>
<p>Windows ç”¨æˆ·è¿˜å¯ä»¥ä½¿ç”¨å‰é¢æåˆ°çš„ Docker é•œåƒã€‚</p>
<h2 id="redisearch-redisjson">æ¨èï¼šRediSearch å’Œ RedisJSON</h2>
<p>Redis OM ä¾èµ– <a href="https://redis.io/docs/stack/search/">RediSearch</a> å’Œ <a href="https://redis.io/docs/stack/json/">RedisJSON</a> Redis æ¨¡å—ï¼Œä»¥æ”¯æŒä¸°å¯Œçš„æŸ¥è¯¢å’ŒåµŒå…¥æ¨¡å‹ã€‚</p>
<p>æ‚¨ä¸éœ€è¦è¿™äº› Redis æ¨¡å—æ¥ä½¿ç”¨ Redis OM çš„æ•°æ®å»ºæ¨¡ã€éªŒè¯å’ŒæŒä¹…åŒ–åŠŸèƒ½ï¼Œä½†æˆ‘ä»¬æ¨èæ‚¨ä½¿ç”¨å®ƒä»¬ä»¥å……åˆ†å‘æŒ¥ Redis OM çš„ä¼˜åŠ¿ã€‚</p>
<p>åœ¨æœ¬åœ°å¼€å‘æœŸé—´è¿è¡Œè¿™äº› Redis æ¨¡å—çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ <a href="https://hub.docker.com/r/redis/redis-stack">redis-stack</a> Docker é•œåƒã€‚</p>
<p>æœ‰å…³å…¶ä»–å®‰è£…æ–¹æ³•ï¼Œè¯·éµå¾ªè¿™ä¸¤ä¸ªæ¨¡å—ä¸»é¡µä¸Šçš„â€œå¿«é€Ÿå…¥é—¨â€æŒ‡å—ã€‚</p>
<h2 id="redis_2">å¯åŠ¨ Redis</h2>
<p>åœ¨å¼€å§‹ä½¿ç”¨ Redis OM ä¹‹å‰ï¼Œè¯·ç¡®ä¿å¯åŠ¨ Redisã€‚</p>
<p>å¯åŠ¨ Redis çš„å‘½ä»¤å°†å–å†³äºæ‚¨å¦‚ä½•å®‰è£…å®ƒã€‚</p>
<h3 id="ubuntu-linux-wsl">Ubuntu Linuxï¼ˆåŒ…æ‹¬ WSLï¼‰</h3>
<p>å¦‚æœæ‚¨ä½¿ç”¨ <code>apt</code> å®‰è£…äº† Redisï¼Œè¯·ä½¿ç”¨ <code>systemctl</code> å‘½ä»¤å¯åŠ¨å®ƒï¼š</p>
<pre><code>$ sudo systemctl restart redis.service
</code></pre>
<p>å¦åˆ™ï¼Œæ‚¨å¯ä»¥æ‰‹åŠ¨å¯åŠ¨æœåŠ¡å™¨ï¼š</p>
<pre><code>$ redis-server start
</code></pre>
<h3 id="homebrew-macos">ä½¿ç”¨ Homebrew çš„ MacOS</h3>
<pre><code>$ brew services start redis
</code></pre>
<h3 id="docker">Docker</h3>
<p>ä½¿ç”¨ Docker å¯åŠ¨ Redis çš„å‘½ä»¤å–å†³äºæ‚¨é€‰æ‹©ä½¿ç”¨çš„é•œåƒã€‚</p>
<p><strong>æç¤ºï¼š</strong> è¿™äº›ç¤ºä¾‹ä¸­çš„ <code>-d</code> é€‰é¡¹ä½¿ Redis åœ¨åå°è¿è¡Œï¼Œè€Œ <code>-p 6379:6379</code> åˆ™ä½¿ Redis å¯ä»¥é€šè¿‡æœ¬åœ°ä¸»æœºçš„ 6379 ç«¯å£è®¿é—®ã€‚</p>
<h4 id="redismod-docker">ä½¿ç”¨ <code>redismod</code> é•œåƒçš„ Dockerï¼ˆæ¨èï¼‰</h4>
<pre><code>$ docker run -d -p 6379:6379 redislabs/redismod
</code></pre>
<h3 id="redis-docker">ä½¿ç”¨ <code>redis</code> é•œåƒçš„ Docker</h3>
<pre><code>$ docker run -d -p 6379:6379 redis
</code></pre>
<h2 id="redis-om_1">å®‰è£… Redis OM</h2>
<p>å®‰è£… Redis OM çš„æ¨èæ–¹æ³•æ˜¯ä½¿ç”¨ <a href="https://python-poetry.org/docs/">Poetry</a>ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é€šè¿‡ Poetry å®‰è£… Redis OMï¼š</p>
<pre><code>$ poetry add redis-om
</code></pre>
<p>å¦‚æœæ‚¨ä½¿ç”¨ Pipenvï¼Œåˆ™å‘½ä»¤ä¸ºï¼š</p>
<pre><code>$ pipenv install redis-om
</code></pre>
<p>æœ€åï¼Œæ‚¨å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤ä½¿ç”¨ <code>pip</code> å®‰è£… Redis OMï¼š</p>
<pre><code>$ pip install redis-om
</code></pre>
<p><strong>æç¤ºï¼š</strong> å¦‚æœæ‚¨ä¸ä½¿ç”¨ Poetry æˆ– Pipenvï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ <code>pip</code> å®‰è£…ï¼Œå»ºè®®æ‚¨åœ¨è™šæ‹Ÿç¯å¢ƒï¼ˆå³ virtualenvï¼‰ä¸­å®‰è£… Redis OMã€‚å¦‚æœæ‚¨å¯¹è¿™ä¸ªæ¦‚å¿µä¸ç†Ÿæ‚‰ï¼Œè¯·å‚é˜… <a href="https://realpython.com/lessons/creating-virtual-environment/">Dan Bader çš„è§†é¢‘å’Œæ–‡å­—è®°å½•</a>ã€‚</p>
<h2 id="redis-url">è®¾ç½® Redis URL ç¯å¢ƒå˜é‡</h2>
<p>æˆ‘ä»¬å¿«è¦å‡†å¤‡å¥½åˆ›å»º Redis OM æ¨¡å‹äº†ï¼ä½†é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿ Redis OM çŸ¥é“å¦‚ä½•è¿æ¥åˆ° Redisã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedis OM å°è¯•è¿æ¥åˆ°æ‚¨æœ¬åœ°ä¸»æœºçš„ 6379 ç«¯å£ã€‚å¤§å¤šæ•°æœ¬åœ°å®‰è£…æ–¹æ³•ä¼šå¯¼è‡´ Redis è¿è¡Œåœ¨è¿™ä¸ªä½ç½®ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ‚¨æ— éœ€åšä»»ä½•ç‰¹åˆ«çš„äº‹æƒ…ã€‚</p>
<p>ç„¶è€Œï¼Œå¦‚æœæ‚¨å°† Redis é…ç½®ä¸ºåœ¨ä¸åŒçš„ç«¯å£ä¸Šè¿è¡Œï¼Œæˆ–è€…æ‚¨æ­£åœ¨ä½¿ç”¨è¿œç¨‹ Redis æœåŠ¡å™¨ï¼Œåˆ™éœ€è¦è®¾ç½® <code>REDIS_OM_URL</code> ç¯å¢ƒå˜é‡ã€‚</p>
<p><code>REDIS_OM_URL</code> ç¯å¢ƒå˜é‡éµå¾ª redis-py URL æ ¼å¼ï¼š</p>
<pre><code>redis://[[username]:[password]]@localhost:6379/[database number]
</code></pre>
<p>é»˜è®¤è¿æ¥ç›¸å½“äºä»¥ä¸‹ <code>REDIS_OM_URL</code> ç¯å¢ƒå˜é‡ï¼š</p>
<pre><code>redis://@localhost:6379
</code></pre>
<p><strong>æç¤ºï¼š</strong> Redis æ•°æ®åº“æ˜¯ç¼–å·çš„ï¼Œé»˜è®¤å€¼ä¸º 0ã€‚æ‚¨å¯ä»¥çœç•¥æ•°æ®åº“ç¼–å·ä»¥ä½¿ç”¨é»˜è®¤æ•°æ®åº“ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong> ç´¢å¼•ä»…é€‚ç”¨äºå­˜å‚¨åœ¨ Redis é€»è¾‘æ•°æ®åº“ 0 ä¸­çš„æ•°æ®ã€‚å¦‚æœåœ¨è¿æ¥åˆ° Redis æ—¶ä½¿ç”¨ä¸åŒçš„æ•°æ®åº“ç¼–å·ï¼Œæ‚¨å¯ä»¥é¢„æœŸä»£ç åœ¨è¿è¡Œè¿ç§»å™¨æ—¶ä¼šå¼•å‘ <code>MigrationError</code>ã€‚</p>
<p>å…¶ä»–æ”¯æŒçš„å‰ç¼€åŒ…æ‹¬ "rediss" ç”¨äº SSL è¿æ¥å’Œ "unix" ç”¨äº Unix åŸŸå¥—æ¥å­—ï¼š</p>
<pre><code>rediss://[[username]:[password]]@localhost:6379/0
unix://[[username]:[password]]@/path/to/socket.sock?db=0
</code></pre>
<h2 id="_3">å®šä¹‰æ¨¡å‹</h2>
<p>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª <code>Customer</code> æ¨¡å‹ï¼Œç”¨äºéªŒè¯å’Œä¿å­˜æ•°æ®ã€‚è®©æˆ‘ä»¬ä»æ¨¡å‹çš„åŸºæœ¬å®šä¹‰å¼€å§‹ã€‚æˆ‘ä»¬å°†é€æ­¥æ·»åŠ åŠŸèƒ½ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">bio</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div>
<p>æœ‰å‡ ä¸ªç»†èŠ‚éœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li>æˆ‘ä»¬çš„ <code>Customer</code> æ¨¡å‹æ‰©å±•äº† <code>HashModel</code> ç±»ã€‚è¿™æ„å‘³ç€å®ƒå°†ä½œä¸ºå“ˆå¸Œä¿å­˜åˆ° Redisã€‚Redis OM æä¾›çš„å¦ä¸€ä¸ªæ¨¡å‹ç±»æ˜¯ <code>JsonModel</code>ï¼Œç¨åæˆ‘ä»¬ä¼šè®¨è®ºã€‚</li>
<li>æˆ‘ä»¬ä½¿ç”¨ Python ç±»å‹æ³¨è§£æŒ‡å®šäº†æ¨¡å‹çš„å­—æ®µã€‚</li>
</ol>
<p>è®©æˆ‘ä»¬æ›´æ·±å…¥åœ°äº†è§£ä¸€ä¸‹ <code>HashModel</code> ç±»å’Œç±»å‹æ³¨è§£ã€‚</p>
<h3 id="hashmodel">HashModel ç±»</h3>
<p>å½“æ‚¨å¯¹ <code>HashModel</code> è¿›è¡Œå­ç±»åŒ–æ—¶ï¼Œæ‚¨çš„å­ç±»æ—¢æ˜¯ Redis OM æ¨¡å‹ï¼Œå…·æœ‰å°†æ•°æ®ä¿å­˜åˆ° Redis çš„æ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ Pydantic æ¨¡å‹ã€‚</p>
<p>è¿™æ„å‘³ç€æ‚¨å¯ä»¥åœ¨ Redis OM æ¨¡å‹ä¸­ä½¿ç”¨ Pydantic å­—æ®µéªŒè¯ï¼Œæˆ‘ä»¬å°†åœ¨åé¢è®¨è®ºéªŒè¯æ—¶æ¶µç›–è¿™ä¸€ç‚¹ã€‚ä½†è¿™ä¹Ÿæ„å‘³ç€æ‚¨å¯ä»¥åœ¨ä»»ä½•éœ€è¦ä½¿ç”¨ Pydantic æ¨¡å‹çš„åœ°æ–¹ä½¿ç”¨ Redis OM æ¨¡å‹ï¼Œæ¯”å¦‚åœ¨æ‚¨çš„ FastAPI åº”ç”¨ç¨‹åºä¸­ã€‚ğŸ¤¯</p>
<h3 id="_4">ç±»å‹æ³¨è§£</h3>
<p>æ‚¨æ·»åŠ åˆ°æ¨¡å‹å­—æ®µçš„ç±»å‹æ³¨è§£ç”¨äºå‡ ä¸ªç›®çš„ï¼š</p>
<ul>
<li>ä½¿ç”¨ Pydantic éªŒè¯å™¨éªŒè¯æ•°æ®</li>
<li>åºåˆ—åŒ–æ•°æ®åˆ° Redis</li>
<li>ä» Redis ååºåˆ—åŒ–æ•°æ®</li>
</ul>
<p>åœ¨æœ¬æ•™ç¨‹çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°è¿™äº›ç”¨é€”çš„ç¤ºä¾‹ã€‚</p>
<p>å…³äº <code>HashModel</code> ç±»çš„ä¸€ä¸ªé‡è¦ç»†èŠ‚æ˜¯ï¼Œå®ƒä¸æ”¯æŒ <code>list</code>ã€<code>set</code> æˆ–æ˜ å°„ï¼ˆå¦‚ <code>dict</code>ï¼‰ç±»å‹ã€‚è¿™æ˜¯å› ä¸º Redis å“ˆå¸Œä¸èƒ½åŒ…å«åˆ—è¡¨ã€é›†åˆæˆ–å…¶ä»–å“ˆå¸Œã€‚</p>
<p>å¦‚æœæ‚¨æƒ³å»ºæ¨¡å¸¦æœ‰åˆ—è¡¨ã€é›†åˆæˆ–æ˜ å°„ç±»å‹çš„å­—æ®µï¼Œæˆ–è€…å…¶ä»–æ¨¡å‹ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ <code>JsonModel</code> ç±»ï¼Œå®ƒå¯ä»¥æ”¯æŒè¿™äº›ç±»å‹ä»¥åŠåµŒå…¥æ¨¡å‹ã€‚</p>
<h2 id="_5">åˆ›å»ºæ¨¡å‹</h2>
<p>è®©æˆ‘ä»¬çœ‹çœ‹åˆ›å»ºæ¨¡å‹å¯¹è±¡çš„æ ·å­ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">bio</span><span class="p">:</span> <span class="nb">str</span>


<span class="n">andrew</span> <span class="o">=</span> <span class="n">Customer</span><span class="p">(</span>
    <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
    <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;Brookins&quot;</span><span class="p">,</span>
    <span class="n">email</span><span class="o">=</span><span class="s2">&quot;andrew.brookins@example.com&quot;</span><span class="p">,</span>
    <span class="n">join_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span>
    <span class="n">age</span><span class="o">=</span><span class="mi">38</span><span class="p">,</span>
    <span class="n">bio</span><span class="o">=</span><span class="s2">&quot;Python developer, works at Redis, Inc.&quot;</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="_6">å¯é€‰å­—æ®µ</h3>
<p>å¦‚æœæˆ‘ä»¬çœç•¥äº†å…¶ä¸­ä¸€ä¸ªå­—æ®µï¼Œæ¯”å¦‚ <code>bio</code>ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>
<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">ValidationError</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">bio</span><span class="p">:</span> <span class="nb">str</span>


<span class="c1"># æ‰€æœ‰å­—æ®µéƒ½æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºæ²¡æœ‰ä»»ä½•å­—æ®µ</span>
<span class="c1"># è¢«æ ‡è®°ä¸º `Optional`ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªéªŒè¯é”™è¯¯ï¼š</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">Customer</span><span class="p">(</span>
        <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
        <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;Brookins&quot;</span><span class="p">,</span>
        <span class="n">email</span><span class="o">=</span><span class="s2">&quot;andrew.brookins@example.com&quot;</span><span class="p">,</span>
        <span class="n">join_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span>
        <span class="n">age</span><span class="o">=</span><span class="mi">38</span>  <span class="c1"># &lt;- æˆ‘ä»¬æ²¡æœ‰ä¼ å…¥ bioï¼</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ValidationError: 1 validation error for Customer</span>
<span class="sd">    bio</span>
<span class="sd">      field required (type=value_error.missing)</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<p>å¦‚æœæˆ‘ä»¬å¸Œæœ› <code>bio</code> å­—æ®µæ˜¯å¯é€‰çš„ï¼Œæˆ‘ä»¬éœ€è¦å°†ç±»å‹æ³¨é‡Šæ›´æ”¹ä¸ºä½¿ç”¨ <code>Optional</code>ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">bio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>  <span class="c1"># &lt;- ç°åœ¨ï¼Œbio æ˜¯ä¸€ä¸ª Optional[str]</span>
</code></pre></div>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥åˆ›å»ºæœ‰æˆ–æ²¡æœ‰ <code>bio</code> å­—æ®µçš„ <code>Customer</code> å¯¹è±¡ã€‚</p>
<h3 id="_7">é»˜è®¤å€¼</h3>
<p>å­—æ®µå¯ä»¥æœ‰é»˜è®¤å€¼ã€‚æ‚¨å¯ä»¥é€šè¿‡ç»™å­—æ®µèµ‹å€¼æ¥è®¾ç½®å®ƒä»¬ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">bio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Super dope&quot;</span>  <span class="c1"># &lt;- æˆ‘ä»¬åœ¨è¿™é‡Œæ·»åŠ äº†é»˜è®¤å€¼</span>
</code></pre></div>
<p>ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ²¡æœ‰ <code>bio</code> å­—æ®µçš„ <code>Customer</code> å¯¹è±¡ï¼Œå®ƒå°†ä½¿ç”¨é»˜è®¤å€¼ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">bio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Super dope&quot;</span>


<span class="n">andrew</span> <span class="o">=</span> <span class="n">Customer</span><span class="p">(</span>
    <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
    <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;Brookins&quot;</span><span class="p">,</span>
    <span class="n">email</span><span class="o">=</span><span class="s2">&quot;andrew.brookins@example.com&quot;</span><span class="p">,</span>
    <span class="n">join_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span>
    <span class="n">age</span><span class="o">=</span><span class="mi">38</span><span class="p">)</span>  <span class="c1"># &lt;- æ³¨æ„ï¼Œæˆ‘ä»¬æ²¡æœ‰æä¾› bioï¼</span>

<span class="nb">print</span><span class="p">(</span><span class="n">andrew</span><span class="o">.</span><span class="n">bio</span><span class="p">)</span>  <span class="c1"># &lt;- æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°äº†é»˜è®¤å€¼ã€‚</span>
<span class="c1"># &gt; &#39;Super Dope&#39;</span>
</code></pre></div>
<p>æ¨¡å‹å°†åœ¨æ‚¨ä¸‹æ¬¡è°ƒç”¨ <code>save()</code> æ—¶å°†æ­¤é»˜è®¤å€¼ä¿å­˜åˆ° Redisã€‚</p>
<h3 id="_8">è‡ªåŠ¨ä¸»é”®</h3>
<p>æ¨¡å‹ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå…¨çƒå”¯ä¸€çš„ä¸»é”®ï¼Œè€Œæ— éœ€ä¸ Redis è¿›è¡Œé€šä¿¡ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">bio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Super dope&quot;</span>


<span class="n">andrew</span> <span class="o">=</span> <span class="n">Customer</span><span class="p">(</span>
    <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
    <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;Brookins&quot;</span><span class="p">,</span>
    <span class="n">email</span><span class="o">=</span><span class="s2">&quot;andrew.brookins@example.com&quot;</span><span class="p">,</span>
    <span class="n">join_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span>
    <span class="n">age</span><span class="o">=</span><span class="mi">38</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">andrew</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
<span class="c1"># &gt; &#39;01FJM6PH661HCNNRC884H6K30C&#39;</span>
</code></pre></div>
<p>ID åœ¨æ‚¨ä¿å­˜æ¨¡å‹ä¹‹å‰å°±å¯ç”¨ã€‚</p>
<p>é»˜è®¤çš„ ID ç”Ÿæˆå‡½æ•°ä¼šåˆ›å»º <a href="https://github.com/ulid/spec">ULIDs</a>ï¼Œä¸è¿‡å¦‚æœæ‚¨æƒ³ä½¿ç”¨ä¸åŒç±»å‹çš„ä¸»é”®ï¼Œå¯ä»¥æ›´æ”¹ç”Ÿæˆæ¨¡å‹ä¸»é”®çš„å‡½æ•°ã€‚</p>
<h2 id="_9">æ•°æ®éªŒè¯</h2>
<p>Redis OM ä½¿ç”¨ <a href="https://github.com/samuelcolvin/pydantic">Pydantic</a> æ ¹æ®æ‚¨ä¸ºæ¨¡å‹ç±»å­—æ®µåˆ†é…çš„ç±»å‹æ³¨é‡Šæ¥éªŒè¯æ•°æ®ã€‚</p>
<p>è¿™ç§éªŒè¯ç¡®ä¿åƒ <code>first_name</code> è¿™æ ·çš„å­—æ®µåœ¨ <code>Customer</code> æ¨¡å‹ä¸­æ ‡è®°ä¸º <code>str</code> æ—¶å§‹ç»ˆä¸ºå­—ç¬¦ä¸²ã€‚<strong>ä½†æ¯ä¸ª Redis OM æ¨¡å‹ä¹Ÿæ˜¯ Pydantic æ¨¡å‹</strong>ï¼Œå› æ­¤æ‚¨å¯ä»¥ä½¿ç”¨ Pydantic éªŒè¯å™¨ï¼Œå¦‚ <code>EmailStr</code>ã€<code>Pattern</code> ç­‰è¿›è¡Œå¤æ‚éªŒè¯ï¼</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¹‹å‰å°† <code>Customer</code> æ¨¡å‹çš„ <code>join_date</code> å®šä¹‰ä¸º <code>datetime.date</code>ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•åˆ›å»ºä¸€ä¸ª <code>join_date</code> ä¸æ˜¯æ—¥æœŸçš„æ¨¡å‹ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªéªŒè¯é”™è¯¯ã€‚</p>
<p>è®©æˆ‘ä»¬ç°åœ¨å°è¯•ä¸€ä¸‹ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>
<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">ValidationError</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">bio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Super dope&quot;</span>


<span class="k">try</span><span class="p">:</span>
    <span class="n">Customer</span><span class="p">(</span>
        <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
        <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;Brookins&quot;</span><span class="p">,</span>
        <span class="n">email</span><span class="o">=</span><span class="s2">&quot;a@example.com&quot;</span><span class="p">,</span>
        <span class="n">join_date</span><span class="o">=</span><span class="s2">&quot;not a date!&quot;</span><span class="p">,</span>  <span class="c1"># &lt;- é—®é¢˜æ‰€åœ¨è¡Œï¼</span>
        <span class="n">age</span><span class="o">=</span><span class="mi">38</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    pydantic.error_wrappers.ValidationError: 1 validation error for Customer</span>
<span class="sd">    join_date</span>
<span class="sd">      invalid date format (type=value_error.date)</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<h3 id="_10">æ¨¡å‹é»˜è®¤å¼ºåˆ¶è½¬æ¢å€¼</h3>
<p>æ‚¨å¯èƒ½ä¼šæƒ³ï¼Œåœ¨æˆ‘ä»¬ä¸Šä¸€ä¸ªéªŒè¯ç¤ºä¾‹ä¸­ï¼Œä»€ä¹ˆç®—ä½œâ€œæ—¥æœŸâ€ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedis OM ä¼šå°è¯•å°†è¾“å…¥å€¼å¼ºåˆ¶è½¬æ¢ä¸ºæ­£ç¡®çš„ç±»å‹ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†æ—¥æœŸå­—ç¬¦ä¸²ä¼ é€’ç»™ <code>join_date</code>ï¼Œè€Œä¸å¿…ä¼ é€’ <code>date</code> å¯¹è±¡ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>


<span class="n">andrew</span> <span class="o">=</span> <span class="n">Customer</span><span class="p">(</span>
    <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
    <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;Brookins&quot;</span><span class="p">,</span>
    <span class="n">email</span><span class="o">=</span><span class="s2">&quot;a@example.com&quot;</span><span class="p">,</span>
    <span class="n">join_date</span><span class="o">=</span><span class="s2">&quot;2020-01-02&quot;</span><span class="p">,</span>  <span class="c1"># &lt;- æˆ‘ä»¬ç°åœ¨ä¼ é€’çš„æ˜¯ YYYY-MM-DD æ—¥æœŸå­—ç¬¦ä¸²</span>
    <span class="n">age</span><span class="o">=</span><span class="mi">38</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">andrew</span><span class="o">.</span><span class="n">join_date</span><span class="p">)</span>
<span class="c1"># &gt; 2021-11-02</span>
<span class="nb">type</span><span class="p">(</span><span class="n">andrew</span><span class="o">.</span><span class="n">join_date</span><span class="p">)</span>
<span class="c1"># &gt; datetime.date  # æ¨¡å‹è‡ªåŠ¨è§£æäº†å­—ç¬¦ä¸²ï¼</span>
</code></pre></div>
<p>è¿™ç§å°†è§£æï¼ˆåœ¨æ­¤æƒ…å†µä¸‹ä¸ºæ—¥æœŸå­—ç¬¦ä¸²ï¼‰ä¸éªŒè¯ç›¸ç»“åˆçš„èƒ½åŠ›å¯ä»¥ä¸ºæ‚¨èŠ‚çœå¾ˆå¤šå·¥ä½œã€‚</p>
<p>ç„¶è€Œï¼Œæ‚¨å¯ä»¥å…³é—­å¼ºåˆ¶è½¬æ¢â€”â€”è¯·æŸ¥çœ‹ä¸‹ä¸€èŠ‚å…³äºä½¿ç”¨ä¸¥æ ¼éªŒè¯çš„å†…å®¹ã€‚</p>
<h3 id="_11">ä¸¥æ ¼éªŒè¯</h3>
<p>æ‚¨å¯ä»¥å¼€å¯ä¸¥æ ¼éªŒè¯ï¼Œä»¥æ‹’ç»å­—æ®µçš„å€¼ï¼Œé™¤éå®ƒä»¬ä¸æ¨¡å‹çš„ç±»å‹æ³¨é‡Šå®Œå…¨åŒ¹é…ã€‚</p>
<p>æ‚¨å¯ä»¥é€šè¿‡å°†å­—æ®µçš„ç±»å‹æ³¨é‡Šæ›´æ”¹ä¸ºä½¿ç”¨ Pydantic æä¾›çš„ <a href="https://pydantic-docs.helpmanual.io/usage/types/#strict-types">"ä¸¥æ ¼" ç±»å‹</a> æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p>
<p>Redis OM æ”¯æŒ Pydantic çš„æ‰€æœ‰ä¸¥æ ¼ç±»å‹ï¼š<code>StrictStr</code>ã€<code>StrictBytes</code>ã€<code>StrictInt</code>ã€<code>StrictFloat</code> å’Œ <code>StrictBool</code>ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬æƒ³ç¡®ä¿ <code>age</code> å­—æ®µä»…æ¥å—æ•´æ•°ï¼Œå¹¶ä¸”ä¸å°è¯•è§£æåŒ…å«æ•´æ•°çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ "1"ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>StrictInt</code> ç±»ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">StrictInt</span><span class="p">,</span> <span class="n">ValidationError</span>
<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="n">StrictInt</span>  <span class="c1"># &lt;- è¿™é‡Œä½¿ç”¨ StrictInt è€Œä¸æ˜¯ int</span>
    <span class="n">bio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>


<span class="c1"># ç°åœ¨å¦‚æœæˆ‘ä»¬å¯¹ `age` ä½¿ç”¨å­—ç¬¦ä¸²è€Œä¸æ˜¯æ•´æ•°ï¼Œ</span>
<span class="c1"># æˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªéªŒè¯é”™è¯¯ï¼š</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">Customer</span><span class="p">(</span>
        <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
        <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;Brookins&quot;</span><span class="p">,</span>
        <span class="n">email</span><span class="o">=</span><span class="s2">&quot;a@example.com&quot;</span><span class="p">,</span>
        <span class="n">join_date</span><span class="o">=</span><span class="s2">&quot;2020-01-02&quot;</span><span class="p">,</span>
        <span class="n">age</span><span class="o">=</span><span class="s2">&quot;38&quot;</span>  <span class="c1"># &lt;- å­—ç¬¦ä¸²ç±»å‹çš„å¹´é¾„ç°åœ¨ä¸åº”è¯¥æœ‰æ•ˆï¼</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    pydantic.error_wrappers.ValidationError: 1 validation error for Customer</span>
<span class="sd">    age</span>
<span class="sd">      Value is not a valid integer (type=type_error.integer)</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<p>Pydantic ä¸åŒ…å« <code>StrictDate</code> ç±»ï¼Œä½†æˆ‘ä»¬å¯ä»¥è‡ªå·±åˆ›å»ºã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª <code>StrictDate</code> ç±»å‹ï¼Œç”¨äºéªŒè¯ <code>join_date</code> æ˜¯ä¸€ä¸ª <code>datetime.date</code> å¯¹è±¡ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">ValidationError</span>
<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>


<span class="k">class</span> <span class="nc">StrictDate</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__get_validators__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;CallableGenerator&#39;</span><span class="p">:</span>
        <span class="k">yield</span> <span class="bp">cls</span><span class="o">.</span><span class="n">validate</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be a datetime.date object&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">StrictDate</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">bio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>


<span class="c1"># ç°åœ¨å¦‚æœæˆ‘ä»¬å¯¹ `join_date` ä½¿ç”¨å­—ç¬¦ä¸²è€Œä¸æ˜¯æ—¥æœŸå¯¹è±¡ï¼Œ</span>
<span class="c1"># æˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªéªŒè¯é”™è¯¯ï¼š</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">Customer</span><span class="p">(</span>
        <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
        <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;Brookins&quot;</span><span class="p">,</span>
        <span class="n">email</span><span class="o">=</span><span class="s2">&quot;a@example.com&quot;</span><span class="p">,</span>
        <span class="n">join_date</span><span class="o">=</span><span class="s2">&quot;2020-01-02&quot;</span><span class="p">,</span>  <span class="c1"># &lt;- å­—ç¬¦ä¸²ç°åœ¨ä¸åº”è¯¥æœ‰æ•ˆï¼</span>
        <span class="n">age</span><span class="o">=</span><span class="s2">&quot;38&quot;</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    pydantic.error_wrappers.ValidationError: 1 validation error for Customer</span>
<span class="sd">    join_date</span>
<span class="sd">      Value must be a datetime.date object (type=value_error)</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<h2 id="_12">ä¿å­˜æ¨¡å‹</h2>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ <code>save()</code> å°†æ¨¡å‹ä¿å­˜åˆ° Redisï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>


<span class="n">andrew</span> <span class="o">=</span> <span class="n">Customer</span><span class="p">(</span>
    <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
    <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;Brookins&quot;</span><span class="p">,</span>
    <span class="n">email</span><span class="o">=</span><span class="s2">&quot;andrew.brookins@example.com&quot;</span><span class="p">,</span>
    <span class="n">join_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span>
    <span class="n">age</span><span class="o">=</span><span class="mi">38</span><span class="p">)</span>

<span class="n">andrew</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div>
<h2 id="_13">è¿‡æœŸæ¨¡å‹</h2>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>expire</code> æ–¹æ³•è®©æ¨¡å‹å®ä¾‹è¿‡æœŸï¼Œå¹¶ä¼ å…¥å¸Œæœ›å®ä¾‹åœ¨ Redis ä¸­è¿‡æœŸçš„ç§’æ•°ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># è®© Andrew åœ¨ 2 åˆ†é’Ÿï¼ˆ120 ç§’ï¼‰åè¿‡æœŸ</span>
<span class="n">andrew</span><span class="o">.</span><span class="n">expire</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>
</code></pre></div>
<h2 id="redis_3">åœ¨ Redis ä¸­æ£€æŸ¥æ•°æ®</h2>
<p>æ‚¨å¯ä»¥æŸ¥çœ‹å­˜å‚¨åœ¨ Redis ä¸­çš„ä»»ä½• Redis OM æ¨¡å‹çš„æ•°æ®ã€‚</p>
<p>é¦–å…ˆï¼Œè·å–æ‚¨æƒ³è¦æ£€æŸ¥çš„æ¨¡å‹å®ä¾‹çš„é”®ã€‚<code>key()</code> æ–¹æ³•å°†ä¸ºæ‚¨æä¾›ç”¨äºå­˜å‚¨æ¨¡å‹çš„ç¡®åˆ‡ Redis é”®ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong> è¿™ä¸ªæ–¹æ³•çš„å‘½åå¯èƒ½ä¼šè®©äººå›°æƒ‘ã€‚è¿™ä¸æ˜¯ä¸»é”®ï¼Œè€Œæ˜¯è¯¥æ¨¡å‹çš„ Redis é”®ã€‚å› æ­¤ï¼Œæ–¹æ³•åç§°å¯èƒ½ä¼šæœ‰æ‰€æ›´æ”¹ã€‚</p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŸ¥çœ‹æˆ‘ä»¬æ­£åœ¨æ„å»ºçš„ <code>Customer</code> æ¨¡å‹çš„é”®ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">bio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Super dope&quot;</span>


<span class="n">andrew</span> <span class="o">=</span> <span class="n">Customer</span><span class="p">(</span>
    <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
    <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;Brookins&quot;</span><span class="p">,</span>
    <span class="n">email</span><span class="o">=</span><span class="s2">&quot;andrew.brookins@example.com&quot;</span><span class="p">,</span>
    <span class="n">join_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span>
    <span class="n">age</span><span class="o">=</span><span class="mi">38</span><span class="p">)</span>

<span class="n">andrew</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">andrew</span><span class="o">.</span><span class="n">key</span><span class="p">()</span>
<span class="c1"># &gt; &#39;mymodel.Customer:01FKGX1DFEV9Z2XKF59WQ6DC9T&#39;</span>
</code></pre></div>
<p>æœ‰äº†æ¨¡å‹çš„ Redis é”®ï¼Œæ‚¨å¯ä»¥å¯åŠ¨ <code>redis-cli</code> å¹¶æ£€æŸ¥è¯¥é”®ä¸‹å­˜å‚¨çš„æ•°æ®ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨æ­£åœ¨è¿è¡Œçš„ "redis" å®¹å™¨è¿è¡Œ <code>JSON.GET</code> å‘½ä»¤ï¼Œè¯¥å®¹å™¨ç”±æ­¤é¡¹ç›®çš„ Docker Compose æ–‡ä»¶å®šä¹‰ï¼š</p>
<div class="highlight"><pre><span></span><code>$ docker compose exec -T redis redis-cli HGETALL mymodel.Customer:01FKGX1DFEV9Z2XKF59WQ6DC9T

 1) &quot;pk&quot;
 2) &quot;01FKGX1DFEV9Z2XKF59WQ6DC9T&quot;
 3) &quot;first_name&quot;
 4) &quot;Andrew&quot;
 5) &quot;last_name&quot;
 6) &quot;Brookins&quot;
 7) &quot;email&quot;
 8) &quot;andrew.brookins@example.com&quot;
 9) &quot;join_date&quot;
10) &quot;2021-11-02&quot;
11) &quot;age&quot;
12) &quot;38&quot;
13) &quot;bio&quot;
14) &quot;Super dope&quot;
</code></pre></div>
<h2 id="_14">è·å–æ¨¡å‹</h2>
<p>å¦‚æœæ‚¨æœ‰æ¨¡å‹çš„ä¸»é”®ï¼Œå¯ä»¥åœ¨æ¨¡å‹ç±»ä¸Šè°ƒç”¨ <code>get()</code> æ–¹æ³•æ¥è·å–æ¨¡å‹çš„æ•°æ®ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">bio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Super dope&quot;</span>


<span class="n">andrew</span> <span class="o">=</span> <span class="n">Customer</span><span class="p">(</span>
    <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Andrew&quot;</span><span class="p">,</span>
    <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;Brookins&quot;</span><span class="p">,</span>
    <span class="n">email</span><span class="o">=</span><span class="s2">&quot;andrew.brookins@example.com&quot;</span><span class="p">,</span>
    <span class="n">join_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span>
    <span class="n">age</span><span class="o">=</span><span class="mi">38</span><span class="p">)</span>

<span class="n">andrew</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">Customer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">andrew</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span> <span class="o">==</span> <span class="n">andrew</span>
</code></pre></div>
<h2 id="_15">ä½¿ç”¨è¡¨è¾¾å¼æŸ¥è¯¢æ¨¡å‹</h2>
<p>Redis OM æä¾›äº†ä¸€ç§ä¸°å¯Œçš„æŸ¥è¯¢è¯­è¨€ï¼Œå…è®¸æ‚¨ä½¿ç”¨ Python è¡¨è¾¾å¼æŸ¥è¯¢ Redisã€‚</p>
<p>ä¸ºäº†å±•ç¤ºè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†å¯¹ä¹‹å‰å®šä¹‰çš„ <code>Customer</code> æ¨¡å‹åšä¸€ä¸ªå°æ”¹åŠ¨ã€‚æˆ‘ä»¬å°†æ·»åŠ  <code>Field(index=True)</code>ï¼Œä»¥å‘Šè¯‰ Redis OM æˆ‘ä»¬å¸Œæœ›ä¸º <code>last_name</code> å’Œ <code>age</code> å­—æ®µå»ºç«‹ç´¢å¼•ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">EmailStr</span>

<span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Field</span><span class="p">,</span>
    <span class="n">HashModel</span><span class="p">,</span>
    <span class="n">Migrator</span>
<span class="p">)</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">email</span><span class="p">:</span> <span class="n">EmailStr</span>
    <span class="n">join_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">bio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>


<span class="c1"># ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬åœ¨å®‰è£…äº† RediSearch æ¨¡å—çš„ Redis éƒ¨ç½²ä¸­ä½¿ç”¨æ­¤æ¨¡å‹ï¼Œ</span>
<span class="c1"># æˆ‘ä»¬å¯ä»¥è¿è¡Œå¦‚ä¸‹æŸ¥è¯¢ã€‚</span>

<span class="c1"># åœ¨è¿è¡ŒæŸ¥è¯¢ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è¿è¡Œè¿ç§»ï¼Œä»¥è®¾ç½® Redis OM å°†ä½¿ç”¨çš„ç´¢å¼•ã€‚</span>
<span class="c1"># æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ `migrate` CLI å·¥å…·æ¥å®ç°è¿™ä¸€ç‚¹ï¼</span>
<span class="n">Migrator</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># æŸ¥æ‰¾æ‰€æœ‰å§“ &quot;Brookins&quot; çš„å®¢æˆ·</span>
<span class="n">Customer</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Customer</span><span class="o">.</span><span class="n">last_name</span> <span class="o">==</span> <span class="s2">&quot;Brookins&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

<span class="c1"># æŸ¥æ‰¾æ‰€æœ‰ä¸å§“ &quot;Brookins&quot; çš„å®¢æˆ·</span>
<span class="n">Customer</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Customer</span><span class="o">.</span><span class="n">last_name</span> <span class="o">!=</span> <span class="s2">&quot;Brookins&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

<span class="c1"># æŸ¥æ‰¾æ‰€æœ‰å§“ &quot;Brookins&quot; æˆ–è€…å¹´é¾„ä¸º 100 ä¸”å§“ &quot;Smith&quot; çš„å®¢æˆ·</span>
<span class="n">Customer</span><span class="o">.</span><span class="n">find</span><span class="p">((</span><span class="n">Customer</span><span class="o">.</span><span class="n">last_name</span> <span class="o">==</span> <span class="s2">&quot;Brookins&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span>
        <span class="n">Customer</span><span class="o">.</span><span class="n">age</span> <span class="o">==</span> <span class="mi">100</span>
<span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">Customer</span><span class="o">.</span><span class="n">last_name</span> <span class="o">==</span> <span class="s2">&quot;Smith&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div>
<h3 id="_16">ä¿å­˜å’ŒæŸ¥è¯¢å¸ƒå°”å€¼</h3>
<p>ç”±äºå†å²åŸå› ï¼Œ<code>HashModels</code> ä¸æ”¯æŒä¿å­˜å’ŒæŸ¥è¯¢å¸ƒå°”å€¼ã€‚ç„¶è€Œï¼Œåœ¨ JSON æ¨¡å‹ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <code>==</code> è¯­æ³•å­˜å‚¨å’ŒæŸ¥è¯¢å¸ƒå°”å€¼ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Field</span><span class="p">,</span>
    <span class="n">JsonModel</span><span class="p">,</span>
    <span class="n">Migrator</span>
<span class="p">)</span>

<span class="k">class</span> <span class="nc">Demo</span><span class="p">(</span><span class="n">JsonModel</span><span class="p">):</span>
    <span class="n">b</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">Migrator</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Demo</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">Demo</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Demo</span><span class="o">.</span><span class="n">b</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<h2 id="redis_4">è°ƒç”¨å…¶ä»– Redis å‘½ä»¤</h2>
<p>æœ‰æ—¶æ‚¨éœ€è¦ç›´æ¥è¿è¡Œ Redis å‘½ä»¤ã€‚Redis OM é€šè¿‡æ¨¡å‹ç±»ä¸Šçš„ <code>db</code> æ–¹æ³•æ”¯æŒè¿™ä¸€ç‚¹ã€‚å®ƒè¿”å›ä¸€ä¸ªå·²è¿æ¥çš„ Redis å®¢æˆ·ç«¯å®ä¾‹ï¼Œè¯¥å®ä¾‹ä¸ºæ¯ä¸ª Redis å‘½ä»¤æä¾›ä¸€ä¸ªå‘½åå‡½æ•°ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬æ‰§è¡Œä¸€äº›åŸºæœ¬çš„é›†åˆæ“ä½œï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">HashModel</span>

<span class="k">class</span> <span class="nc">Demo</span><span class="p">(</span><span class="n">HashModel</span><span class="p">):</span>
    <span class="n">some_field</span><span class="p">:</span> <span class="nb">str</span>

<span class="n">redis_conn</span> <span class="o">=</span> <span class="n">Demo</span><span class="o">.</span><span class="n">db</span><span class="p">()</span>

<span class="n">redis_conn</span><span class="o">.</span><span class="n">sadd</span><span class="p">(</span><span class="s2">&quot;myset&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span>

<span class="c1"># è¾“å‡º False</span>
<span class="nb">print</span><span class="p">(</span><span class="n">redis_conn</span><span class="o">.</span><span class="n">sismember</span><span class="p">(</span><span class="s2">&quot;myset&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">))</span>

<span class="c1"># è¾“å‡º True</span>
<span class="nb">print</span><span class="p">(</span><span class="n">redis_conn</span><span class="o">.</span><span class="n">sismember</span><span class="p">(</span><span class="s2">&quot;myset&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">))</span>
</code></pre></div>
<p>æ¯ä¸ªå‘½ä»¤å‡½æ•°é¢„æœŸçš„å‚æ•°ä¸ <a href="https://redis.io/commands/">redis.io</a> ä¸Šå‘½ä»¤é¡µé¢ä¸­è®°å½•çš„å‚æ•°ç›¸åŒã€‚</p>
<p>å¦‚æœæ‚¨ä¸æƒ³ä»æ¨¡å‹ç±»è·å– Redis è¿æ¥ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨ <code>get_redis_connection</code>ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">redis_om</span> <span class="kn">import</span> <span class="n">get_redis_connection</span>

<span class="n">redis_conn</span> <span class="o">=</span> <span class="n">get_redis_connection</span><span class="p">()</span>
<span class="n">redis_conn</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="_17">ä¸‹ä¸€æ­¥</h2>
<p>ç°åœ¨æ‚¨å·²ç»äº†è§£äº†ä½¿ç”¨ Redis OM çš„åŸºç¡€çŸ¥è¯†ï¼Œå¯ä»¥åœ¨æ‚¨çš„é¡¹ç›®ä¸­å¼€å§‹å°è¯•å®ƒï¼</p>
<p>å¦‚æœæ‚¨æ˜¯ FastAPI ç”¨æˆ·ï¼Œè¯·æŸ¥çœ‹ <a href="../fastapi_integration/">å¦‚ä½•å°† Redis OM é›†æˆåˆ° FastAPI ä¸­</a>ã€‚</p>
<!-- Links -->





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.top", "navigation.sections", "search.suggest", "search.highlight", "content.code.annotate", "content.code.copy"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.94c44541.min.js"></script>
      
    
  </body>
</html>